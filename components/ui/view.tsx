'use client'

import { useView } from '@/context/view'
import { AnimatePresence, motion } from 'motion/react'
import dynamic from 'next/dynamic'

import Nav from '@/components/ui/nav'
import { useEffect } from 'react'

const Contact = dynamic(() => import('@/components/ui/contact'))

const Loading = () => {
  const { setView } = useView()

  useEffect(() => {
    setTimeout(() => setView(null), 2000)
  }, [])

  return (
    <motion.div
      exit={{
        opacity: 0,
      }}
      transition={{ duration: 0.2, ease: 'easeOut' }}
      className={
        'fixed top-0 left-0 w-screen h-screen bg-black/25 backdrop-blur-2xl z-10 flex flex-col justify-center items-center gap-[4vh]'
      }
    >
      <div className={'w-full h-1/2 flex justify-center items-start z-0 overflow-clip'}>
        <div className={'w-full h-[4rem] flex justify-center items-center'}>
          <svg
            viewBox="0 0 544 87"
            xmlns="http://www.w3.org/2000/svg"
            className={'fill-white w-[16vh] animate-loading-logo'}
          >
            <path
              d="M290.083 2.24481L273.906 61.4948C273.521 63.0469 273.099 64.5677 272.641 66.0573C272.177 67.5573 271.719 69.0781 271.26 70.6146C270.708 69.0781 270.198 67.5365 269.698 66.0052C269.198 64.4531 268.635 62.9271 268.026 61.3854L247.005 2.25523H245.625L224.719 61.5052C224.099 63.0573 223.542 64.5729 223.042 66.0677C222.542 67.5677 221.979 69.0834 221.37 70.625C220.99 69.0834 220.568 67.5469 220.109 66.0156C219.651 64.4636 219.219 62.9375 218.838 61.3959L202.547 2.26565H197.005L220.12 85.1875H221.38L243.552 22.474L246.333 15.0834C246.713 16.3125 247.125 17.5469 247.547 18.7761C247.963 20.0156 248.406 21.2448 248.875 22.474L271.167 85.1875H272.547L295.661 2.26565H290.12L290.083 2.24481Z"
              className={'animate-loading-watch'}
            />
            <path
              d="M360.771 23.8333V38.8542C358.151 33.5469 354.552 29.4427 349.969 26.5521C345.38 23.6667 340.089 22.224 334.078 22.224C329.375 22.224 325.089 23.1146 321.203 24.8854C317.307 26.6563 313.984 29.0261 311.214 31.9948C308.443 34.9531 306.281 38.3854 304.745 42.2761C303.193 46.1667 302.432 50.224 302.432 54.4531C302.432 58.6875 303.193 62.7448 304.745 66.5833C306.281 70.4375 308.443 73.8438 311.214 76.8073C313.995 79.7656 317.297 82.1354 321.146 83.9063C324.995 85.6875 329.266 86.5677 333.969 86.5677C340.208 86.5677 345.599 85.1667 350.141 82.3542C354.682 79.5469 358.219 75.7031 360.771 70.8542V85.1771H365.964V23.8438H360.771V23.8333ZM358.87 66.4063C357.37 69.7552 355.359 72.5833 352.87 74.8958C350.37 77.2083 347.51 78.9375 344.318 80.0833C341.13 81.2344 337.787 81.8177 334.328 81.8177C330.406 81.8177 326.818 81.0833 323.589 79.6146C320.344 78.1563 317.583 76.1875 315.266 73.724C312.953 71.2552 311.146 68.3646 309.844 65.0573C308.526 61.7448 307.885 58.2448 307.885 54.5469C307.885 50.8438 308.495 47.5729 309.724 44.2656C310.953 40.9531 312.734 38.0261 315.037 35.4948C317.344 32.9427 320.135 30.9323 323.417 29.4323C326.688 27.9323 330.328 27.1771 334.328 27.1771C338.568 27.1771 342.339 27.9531 345.662 29.4844C348.969 31.0261 351.781 33.0833 354.089 35.6667C356.401 38.2448 358.151 41.1927 359.344 44.5052C360.531 47.8125 361.13 51.2448 361.13 54.7865C361.13 59.1771 360.38 63.0469 358.88 66.3958L358.87 66.4063Z"
              className={'animate-loading-watch'}
            />
            <path
              d="M396.349 23.8334V0.854187H391.156V23.8334H379.255V28.4531H391.156V85.1667H396.349V28.4531H410.208V23.8334H396.349Z"
              className={'animate-loading-watch'}
            />
            <path
              d="M472.24 69.9271C466.307 77.8646 458.146 81.8281 447.745 81.8281C443.823 81.8281 440.214 81.1146 436.943 79.6875C433.672 78.2552 430.865 76.3177 428.51 73.8542C426.161 71.3959 424.333 68.5052 423.031 65.1979C421.714 61.8854 421.073 58.3438 421.073 54.5677C421.073 50.7865 421.719 47.3438 423.031 43.9948C424.344 40.6459 426.161 37.7344 428.51 35.2761C430.865 32.8073 433.672 30.8542 436.943 29.3854C440.214 27.9271 443.823 27.1823 447.745 27.1823C453.135 27.1823 457.776 28.224 461.667 30.3021C465.557 32.3854 468.891 35.3854 471.656 39.3125L475.359 36.0729C472.427 31.6927 468.641 28.2865 463.979 25.8542C459.318 23.4271 453.948 22.2136 447.865 22.2136C443.016 22.2136 438.625 23.0729 434.703 24.8125C430.771 26.5469 427.38 28.8854 424.542 31.8021C421.693 34.7344 419.49 38.1667 417.948 42.0834C416.401 46.0052 415.641 50.1667 415.641 54.5573C415.641 58.9427 416.411 63.0729 417.948 66.9636C419.49 70.8646 421.672 74.2656 424.479 77.1875C427.292 80.1146 430.661 82.4375 434.583 84.1771C438.516 85.9063 442.896 86.7761 447.745 86.7761C454.214 86.7761 459.766 85.5469 464.375 83.0834C469 80.6146 472.927 77.2656 476.172 73.0365L472.24 69.9167V69.9271Z"
              className={'animate-loading-watch'}
            />
            <path
              d="M537.677 29.5052C533.708 24.6563 528.068 22.224 520.755 22.224C515.745 22.224 511.146 23.4531 506.953 25.9271C502.766 28.3854 499.193 32.1667 496.26 37.2448V0.161469H491.073V85.1771H496.26V52.8333C496.26 49.2969 496.865 45.9636 498.052 42.8438C499.245 39.724 500.922 37.0052 503.073 34.6458C505.224 32.3073 507.755 30.4323 510.646 29.0521C513.537 27.6667 516.667 26.974 520.057 26.974C523.448 26.974 526.177 27.5365 528.49 28.6458C530.797 29.7656 532.677 31.375 534.141 33.4948C535.599 35.6146 536.688 38.1927 537.38 41.2344C538.068 44.2761 538.417 47.724 538.417 51.5729V85.1875H543.609V50.7761C543.609 41.4531 541.63 34.375 537.656 29.5261L537.677 29.5052Z"
              className={'animate-loading-watch'}
            />
            <path
              d="M40.8385 7.5521V2.24481H0.520752V85.1667H5.94263V43.0156H40.828V37.7031H5.94263V7.56252H40.828L40.8385 7.5521Z"
              className={'animate-loading-flite'}
            />
            <path
              d="M53.8801 0.161469V85.1771H59.078V0.161469H53.8801Z"
              className={'animate-loading-flite'}
            />
            <path
              d="M82.703 2.70315C81.7343 1.78648 80.6041 1.32294 79.2916 1.32294C77.9791 1.32294 76.8489 1.78648 75.8801 2.70315C74.9114 3.62502 74.4426 4.78648 74.4426 6.16669C74.4426 7.54169 74.901 8.6146 75.8228 9.57294C76.7395 10.5417 77.901 11.0156 79.2916 11.0156C80.6041 11.0156 81.7343 10.5365 82.703 9.57294C83.6614 8.6146 84.1405 7.4844 84.1405 6.16669C84.1405 4.78648 83.651 3.62502 82.703 2.70315ZM76.7499 23.8334V85.1667H81.953V23.8334H76.7499Z"
              className={'animate-loading-flite'}
            />
            <path
              d="M112.099 23.8334V0.854187H106.896V23.8334H95.0051V28.4531H106.896V85.1667H112.099V28.4531H125.948V23.8334H112.099Z"
              className={'animate-loading-flite'}
            />
            <path
              d="M187.526 65.8854C185.068 70.5833 181.875 74.375 177.948 77.2656C174.016 80.1563 168.974 81.5938 162.813 81.5938C158.964 81.5938 155.443 80.9479 152.245 79.6354C149.042 78.3281 146.333 76.5052 144.094 74.1563C143.214 73.224 142.411 72.2344 141.682 71.1563L164.604 55.0365L171.339 50.3073L185.229 40.5469L189.62 37.4531C188.87 36.1458 188.026 34.9167 187.099 33.7552C186.406 32.875 185.667 32.0469 184.87 31.2552C182.026 28.4063 178.688 26.1823 174.875 24.6042C171.068 23.026 166.964 22.2344 162.573 22.2344C157.646 22.2344 153.234 23.1771 149.354 25.0625C145.453 26.9531 142.182 29.4271 139.531 32.4635C136.87 35.5052 134.859 38.9375 133.469 42.7448C132.089 46.5573 131.391 50.3854 131.391 54.2344C131.391 58.776 132.099 63.0156 133.531 66.9479C133.969 68.1354 134.448 69.2865 135.01 70.375C135.682 71.7448 136.443 73.026 137.302 74.2448C138.021 75.2865 138.802 76.276 139.661 77.2135C142.323 80.1458 145.615 82.4375 149.531 84.0938C153.464 85.7448 157.885 86.5781 162.813 86.5781C169.583 86.5781 175.427 84.974 180.307 81.7865C185.198 78.5938 189.068 74.1042 191.917 68.3333L187.526 65.9063V65.8854ZM138.839 65.7135C137.573 62.4479 136.891 58.8854 136.823 55.026C136.76 53.4427 137.281 50.2969 137.281 50.2969C137.901 46.3646 138.99 42.9531 140.573 40.0729C142.151 37.1927 144.062 34.8073 146.281 32.9167C148.521 31.026 151.042 29.6042 153.854 28.6354C156.661 27.6771 159.563 27.1927 162.573 27.1927C165.583 27.1927 168.385 27.6823 171.234 28.6354C174.078 29.6042 176.688 31.026 179.036 32.9167C180.417 34.026 181.677 35.3073 182.797 36.7656L163.557 50.2969L156.823 55.026L139.479 67.2135C139.25 66.724 139.042 66.224 138.839 65.7135Z"
              className={'animate-loading-flite'}
            />
          </svg>
        </div>
      </div>
      <div className={'w-full h-1/2 flex flex-col justify-start items-center z-10'}>
        <div className={'w-[32vh] h-[0.1vh]'}>
          <div className={'bg-white h-full animate-loading-bar'} />
        </div>
      </div>
    </motion.div>
  )
}

const View = () => {
  const { view, setView } = useView()

  return (
    <AnimatePresence mode={'popLayout'}>
      {view && view !== 'loading' && (
        <motion.div
          key={'blur'}
          initial={{
            backgroundColor: 'rgba(255, 255, 255, 0)',
            backdropFilter: 'blur(0)',
          }}
          animate={{
            backgroundColor: 'rgba(255, 255, 255, 0.1)',
            backdropFilter: 'blur(10px)',
          }}
          exit={{
            backgroundColor: 'rgba(255, 255, 255, 0)',
            backdropFilter: 'blur(0)',
          }}
          transition={{ duration: 0.2, ease: 'easeInOut' }}
          className={'fixed w-screen h-screen inset-0 cursor-pointer z-10'}
          onClick={() => setView(null)}
        />
      )}
      {(view === 'loading' || view === null) && (
        <motion.div
          key={'nav'}
          initial={{ translateY: '-100%' }}
          animate={{ translateY: 0 }}
          exit={{ translateY: '-100%' }}
          className={'fixed w-full z-10'}
        >
          <Nav key={'navigation'} />
        </motion.div>
      )}
      {view === 'loading' && <Loading />}
      {view === 'contact' && <Contact key={'contact'} fixed />}
    </AnimatePresence>
  )
}

export default View
